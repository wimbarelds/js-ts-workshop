# `async` & `await`

## Async/Await syntax

**Async/await** maakt asynchrone code leesbaarder.

```ts
// Met Promises (oud)
fetch('https://jsonplaceholder.typicode.com/users/1')
  .then(response => response.json())
  .then(data => console.log(data));

// Met async/await (nieuw)
async function getUser() {
  const response = await fetch('https://jsonplaceholder.typicode.com/users/1');
  const data = await response.json();
  console.log(data);
}
```

## Async functie

Een functie met `async` **geeft altijd een Promise terug**.

```ts
async function haalData() {
  return 'Hello World';
}

// Dit is equivalent met:
function haalData() {
  return Promise.resolve('Hello World');
}

// Gebruik:
haalData().then(result => console.log(result)); // "Hello World"
```

## Await keyword

`await` **wacht** tot een Promise is afgerond.

```ts
async function voorbeeld() {
  console.log('Start');
  
  const response = await fetch('https://jsonplaceholder.typicode.com/posts/1');
  const post = await response.json();
  
  console.log('Post titel:', post.title);
  console.log('Klaar');
}

voorbeeld();
```

## Error handling

Gebruik `try/catch` voor error handling.

```ts
async function haalUserData(id: number) {
  try {
    const response = await fetch(`https://jsonplaceholder.typicode.com/users/${id}`);
    
    if (!response.ok) {
      throw new Error(`HTTP error! status: ${response.status}`);
    }
    
    const user = await response.json();
    console.log('User:', user.name);
    return user;
  } catch (error) {
    console.error('Fout bij ophalen user:', error);
    return null;
  }
}
```

## Meerdere requests

```ts
// Sequentieel (na elkaar)
async function sequentieelExample() {
  const user1 = await fetch('https://jsonplaceholder.typicode.com/users/1');
  const user2 = await fetch('https://jsonplaceholder.typicode.com/users/2');
  
  // Duurt langer omdat ze na elkaar worden uitgevoerd
}

// Parallel (tegelijk)
async function parallelExample() {
  const [response1, response2] = await Promise.all([
    fetch('https://jsonplaceholder.typicode.com/users/1'),
    fetch('https://jsonplaceholder.typicode.com/users/2')
  ]);
  
  const user1 = await response1.json();
  const user2 = await response2.json();
  
  // Sneller omdat ze tegelijk worden uitgevoerd
}
```

## Praktisch voorbeeld

```ts
interface Post {
  id: number;
  title: string;
  body: string;
  userId: number;
}

async function toonPost(id: number): Promise<void> {
  try {
    console.log(`Ophalen van post ${id}...`);
    
    const response = await fetch(`https://jsonplaceholder.typicode.com/posts/${id}`);
    const post: Post = await response.json();
    
    console.log('\n--- POST ---');
    console.log('Titel:', post.title);
    console.log('Inhoud:', post.body);
    
  } catch (error) {
    console.error('Kon post niet ophalen:', error);
  }
}

// Aanroepen:
toonPost(1);
```

## Top-level await

In moderne Node.js (>= 14.8) kun je `await` buiten een async functie gebruiken:

```ts
// Direct in een .mjs bestand of met "type": "module" in package.json
const response = await fetch('https://jsonplaceholder.typicode.com/users/1');
const user = await response.json();
console.log(user.name);
```
