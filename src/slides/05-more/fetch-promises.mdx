# Fetch & Promises

## Wat is asynchrone code?

**Asynchrone code** wacht niet op het resultaat voordat het verder gaat.

```js
console.log('Start');
setTimeout(() => console.log('Na 1 seconde'), 1000);
console.log('Einde');

// Output:
// "Start"
// "Einde"
// "Na 1 seconde" (na 1 seconde)
```

## Fetch API

De **fetch** functie haalt data op van het internet.

```js
// Fetch geeft een Promise terug
const promise = fetch('https://api.example.com/data');
console.log(promise); // Promise<pending>
```

## Wat zijn Promises?

Een **Promise** is een belofte voor een toekomstig resultaat.

```js
fetch('https://jsonplaceholder.typicode.com/users/1')
  .then(response => {
    console.log('Response ontvangen!');
    return response.json(); // Ook een Promise!
  })
  .then(data => {
    console.log('Data:', data);
  })
  .catch(error => {
    console.error('Fout:', error);
  });
```

## Promise states

```js
// Pending - wacht nog op resultaat
// Fulfilled - succesvol afgerond
// Rejected - er ging iets fout

fetch('/api/data')
  .then(response => {
    if (!response.ok) {
      throw new Error('Network response was not ok');
    }
    return response.json();
  })
  .then(data => console.log(data))
  .catch(error => console.error('Error:', error));
```

## Response verwerken

```js
fetch('https://jsonplaceholder.typicode.com/posts/1')
  .then(response => {
    console.log('Status:', response.status);
    console.log('OK:', response.ok);
    
    return response.json(); // Parse als JSON
  })
  .then(post => {
    console.log('Titel:', post.title);
    console.log('Inhoud:', post.body);
  });
```

## Probleem met chains

```js
// Promise chains kunnen onoverzichtelijk worden
fetch('/api/user/1')
  .then(response => response.json())
  .then(user => {
    return fetch(`/api/posts?userId=${user.id}`);
  })
  .then(response => response.json())
  .then(posts => {
    return fetch(`/api/comments?postId=${posts[0].id}`);
  })
  .then(response => response.json())
  .then(comments => {
    console.log('Comments:', comments);
  })
  .catch(error => {
    console.error('Error:', error);
  });
```
